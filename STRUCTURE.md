# Структура проекта tm.nvim

Краткое описание структуры проекта для быстрой навигации.

## Директории и файлы

```
tm.nvim/
├── lua/tm/                 # Основные модули плагина
│   ├── init.lua           # Entry point, функция setup()
│   ├── config.lua         # Конфигурация и дефолтные настройки
│   ├── core.lua           # Логика работы с tm CLI
│   ├── telescope.lua      # Интеграция с Telescope
│   ├── statusline.lua     # Интеграция с lualine
│   └── commands.lua       # Регистрация Neovim команд
│
├── plugin/                # Автозагрузка плагина
│   └── tm.lua            # Проверка версии и инициализация
│
├── README.md             # Основная документация для пользователей
├── TECHNICAL.md          # Техническая документация для разработчиков
├── STRUCTURE.md          # Этот файл - структура проекта
├── CHANGELOG.md          # История изменений
├── LICENSE               # MIT лицензия
├── example_config.lua    # Примеры конфигурации
└── .gitignore           # Игнорируемые файлы

```

## Описание модулей

### lua/tm/init.lua
**Размер:** ~80 строк
**Назначение:** Главная точка входа в плагин
**Экспорт:**
- `setup(user_config)` - функция инициализации
- `statusline` - компонент для lualine

### lua/tm/config.lua
**Размер:** ~50 строк
**Назначение:** Управление конфигурацией
**Экспорт:**
- `defaults` - дефолтные настройки
- `options` - текущая конфигурация
- `setup(user_config)` - объединение конфигураций

### lua/tm/core.lua
**Размер:** ~300 строк
**Назначение:** Ядро плагина, работа с tm CLI
**Основные функции:**
- `is_tm_installed()` - проверка установки tm
- `workspace_exists()` - проверка workspace
- `execute_tm_command()` - асинхронное выполнение команд
- `init_workspace()` - инициализация workspace
- `add_note()` - добавление заметки
- `list_notes()` - получение списка заметок
- `remove_note()` - удаление заметки
- `archive_note()` - архивирование заметки
- `compact_notes()` - компактизация ID
- `find_notes()` - поиск заметок
- `list_workspaces()` - список пространств
- Функции парсинга вывода tm

### lua/tm/telescope.lua
**Размер:** ~350 строк
**Назначение:** Интеграция с Telescope
**Основные функции:**
- `list_notes()` - picker для списка заметок
- `global_list()` - picker для глобального списка
- `find_notes()` - picker для поиска
- `find_global()` - picker для глобального поиска
- Вспомогательные функции для actions и previewers

### lua/tm/statusline.lua
**Размер:** ~90 строк
**Назначение:** Интеграция со статусной строкой
**Основные функции:**
- `update()` - обновление счетчика заметок
- `component()` - компонент для lualine
- `setup_autocommands()` - настройка автообновления
- `get_lualine_config()` - конфигурация для lualine

### lua/tm/commands.lua
**Размер:** ~150 строк
**Назначение:** Регистрация команд Neovim
**Команды:**
- `:TmAddNote [-p ID]`
- `:TmList [-p ID]`
- `:TmGlobalList`
- `:TmFind <TEXT> [-p ID]`
- `:TmFindGlobal <TEXT>`
- `:TmInit`

### plugin/tm.lua
**Размер:** ~15 строк
**Назначение:** Автозагрузка и проверка версии
**Функции:**
- Проверка версии Neovim >= 0.8.0
- Защита от повторной загрузки

## Документация

### README.md
Основная документация для пользователей:
- Описание возможностей
- Требования и зависимости
- Инструкции по установке
- Примеры конфигурации
- Описание команд и привязок клавиш
- Примеры использования
- Troubleshooting

### TECHNICAL.md
Техническая документация для разработчиков:
- Архитектура плагина
- Подробное описание каждого модуля
- Процессы и потоки данных
- Интеграция с tm CLI
- Работа с Telescope
- Асинхронность
- Расширение функциональности
- Отладка и тестирование

### example_config.lua
Примеры конфигурации для различных менеджеров плагинов:
- lazy.nvim
- packer.nvim
- vim-plug
- Примеры кастомизации

## Зависимости

### Обязательные
- **telescope.nvim** - для пикеров и селекторов
- **plenary.nvim** - для асинхронных операций (требуется Telescope)
- **tm CLI** - инструмент Task Manager

### Опциональные
- **lualine.nvim** - для интеграции со статусной строкой

## Размер проекта

- **Всего строк кода:** ~1000 строк Lua
- **Модулей:** 6 основных модулей
- **Команд:** 6 пользовательских команд
- **Документация:** 3 файла документации

## Точки расширения

1. **Новые команды tm** - добавить в `core.lua` и `commands.lua`
2. **Новые Telescope pickers** - добавить в `telescope.lua`
3. **Дополнительные actions** - расширить `create_note_actions()`
4. **Интеграция с другими плагинами** - добавить в `init.lua`
5. **Дополнительные настройки** - расширить `config.defaults`

## Навигация по коду

**Хотите понять, как работает:**

- **Добавление заметки?** → `commands.lua:add_note()` → `core.lua:add_note()`
- **Telescope picker?** → `commands.lua:list()` → `telescope.lua:list_notes()`
- **Статусная строка?** → `statusline.lua:update()` → `core.lua:get_active_count()`
- **Парсинг вывода tm?** → `core.lua:parse_*()` функции
- **Конфигурация?** → `config.lua:defaults` и `init.lua:setup()`

## Быстрый старт для разработчиков

1. Изучите `README.md` для понимания возможностей
2. Прочитайте `TECHNICAL.md` для понимания архитектуры
3. Начните с `lua/tm/init.lua` - точка входа
4. Изучите `lua/tm/core.lua` - ядро функциональности
5. Посмотрите `lua/tm/telescope.lua` для UI части
6. Используйте `example_config.lua` для тестирования

## Вклад в проект

При добавлении новой функциональности:

1. Добавьте функцию в соответствующий модуль
2. Обновите документацию в README.md
3. Добавьте технические детали в TECHNICAL.md
4. Обновите CHANGELOG.md
5. Добавьте пример в example_config.lua (если нужно)

## Контакты

Для вопросов и предложений создавайте issue в репозитории проекта.
